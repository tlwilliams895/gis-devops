<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Project Week 5: Display Zika Reports on Map &#8212; LaunchCode: GIS DevOps  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
          GIS DevOps</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="/installations/index.html">Installations</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ol>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day1/index.html">Week 1 - Day 1: Welcome, Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day2/index.html">Week 1 - Day 2: Terminal, Shell, Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day3/index.html">Week 1 - Day 3: Shell, Git, SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day4/index.html">Week 1 - Day 4: SQL, HTTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day5/index.html">Week 1 - Day 5: HTTP, Docker</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day1/index.html">Week 2 - Day 1: HTML, CSS, Browser DevTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day2/index.html">Week 2 - Day 2: HTML/CSS Template, JavaScript Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day3/index.html">Week 2 - Day 3: Programming Fundamentals, JavaScript, DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day4/index.html">Week 2 - Day 4: JS, DOM, Promises, AJAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day5/index.html">Week 2 - Day 5: Promises, AJAX, HTTP</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day1/index.html">Week 3 - Day 1: Java, OOP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day2/index.html">Week 3 - Day 2: Spring Boot, Controllers, Routes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day3/index.html">Week 3 - Day 3: Models, ORM (Hibernate)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day4/index.html">Week 3 - Day 4: Persistence, ORM Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day5/index.html">Week 3 - Day 5: Review</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day1/index.html">Week 4 - Day 1: Git, GitLab, IntelliJ, Refactoring, Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day2/index.html">Week 4 - Day 2: Security, Test-driven development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day3/index.html">Week 4 - Day 3: Integration testing, dependency injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day4/index.html">Week 4 - Day 4: Postgres, Spring Data, JPA, Hibernate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day5/index.html">Week 4 - Day 5: AJAX, Open Layers</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../project/index.html">Week 5 - Project Week: Zika Mission Control</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day1/index.html">Week 6 - Day 1: RESTful web services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day2/index.html">Week 6 - Day 2: Swagger REST framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day3/index.html">Week 6 - Day 3: Intro to Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day4/index.html">Week 6 - Day 4: More Elasticsearch, Integrating ES with Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day5/index.html">Week 6 - Day 5: ES2015, ESLint, OpenLayers</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week07/project/index.html">Week 7 - Project Week: Zika Mission Control Part 2</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day1/index.html">Week 8 - Day 1: Intro to DevOps/AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day2/index.html">Week 8 - Day 2: More with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day3/index.html">Week 8 - Day 3: 12 Factor Apps and Auto Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day4/index.html">Week 8 - Day 4: Gradle, Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day5/index.html">Week 8 - Day 5: Sonarqube</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week09/project/index.html">Week 9 - Project Week: Zika Mission Control Part 3</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week11/project/index.html">Week 11 - Project Week: Zika Mission Control Part 4</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day3/index.html">Week 12 - Day 3: Intro to Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day4/index.html">Week 12 - Day 4: OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day5/index.html">Week 12 - Day 5: Certificates</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/aws-intro/index.html">Walkthrough: Intro to AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/aws-rds-vpc/index.html">Walkthrough: Introduction to Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/certificate-authority/index.html">Certificate Authority</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/client-certificates/index.html">Client Certificates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/docker/index.html">Walkthrough: Intro to Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/elasticsearch-spring/index.html">Walkthrough: Elasticsearch in Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/elasticsearch/index.html">Walkthrough: Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/elasticsearch2/index.html">Walkthrough: Elasticsearch Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/eslint-airwaze/index.html">Walkthrough: ESLint Airwaze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/gitLab/index.html">Walkthrough: Git and Gitlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/gradle/index.html">Walkthrough: Gradle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/hashing-salting/index.html">Walkthrough: Hashing and Salting Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/jenkins/index.html">Walkthrough: CI/CD With Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/launchcart-rest/index.html">Walkthrough: LaunchCart REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/oauth2/index.html">Visual OAuth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/openlayers/index.html">Walkthrough: OpenLayers and jQuery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/postgress/index.html">Walkthrough: PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/sonarqube/index.html">Walkthrough: Sonarqube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/spring-data-jpa-hibernate/index.html">Walkthrough: Cars Demo - Spring Data, JPA, Hibernate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/spring-integration-testing/index.html">Walkthrough: Spring Integration Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/swagger/index.html">Walkthrough: SwaggerUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/tdd/index.html">Walkthrough: TDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/unit-tests/index.html">Walkthrough: Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../walkthroughs/upgrading-spring-boot/index.html">Walkthrough: Upgrading to Spring Boot 2.x</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../installations/00-prep-week/index.html">Installation: Essential Tooling &amp; Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/01-docker/index.html">Installation: Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/02-docker-psql/index.html">Installation: Docker PSQL Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/03-docker-postgis/index.html">Installation: Docker PostGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/04-docker-elasticsearch/index.html">Installation: Docker Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/05-docker-kibana/index.html">Installation: Docker Kibana</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/06-docker-jenkins/index.html">Installation: Docker Jenkins</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/00-intellij/index.html">Configuration: IntelliJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/01-runtime-configurations/index.html">Configuration: IntelliJ - Runtime Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/02-environment-variables-intellij/index.html">Configuration: Environment Variables - IntelliJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/04-spring-elasticsearch/index.html">Configuration: Spring &amp; Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/05-spring-postgres/index.html">Configuration: Spring &amp; Postgres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/06-vscode-eslint/index.html">Configuration: Visual Studio Code - ESLint</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../notes/docker/index.html">Docker</a></li>
</ol>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Project Week 5: Display Zika Reports on Map</a><ul>
<li><a class="reference internal" href="#design-report-java-class">Design Report.java Class</a></li>
<li><a class="reference internal" href="#create-reporttests-java">Create ReportTests.java</a></li>
<li><a class="reference internal" href="#populate-report-table">Populate Report table</a></li>
<li><a class="reference internal" href="#create-reportrepository-java">Create ReportRepository.java</a></li>
<li><a class="reference internal" href="#create-reportrepositorytests-java">Create ReportRepositoryTests.java</a></li>
<li><a class="reference internal" href="#create-reportcontroller-java">Create ReportController.java</a><ul>
<li><a class="reference internal" href="#convert-java-object-to-geojson">Convert Java Object to GeoJSON</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-reportcontrollertests-java">Create ReportControllerTests.java</a></li>
<li><a class="reference internal" href="#amend-script-js">Amend script.js</a></li>
<li><a class="reference internal" href="#verify-zika-report-layer-renders">Verify Zika report layer renders</a></li>
<li><a class="reference internal" href="#commit">Commit</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="project-week-5-display-zika-reports-on-map">
<span id="week5-display-reports"></span><h1>Project Week 5: Display Zika Reports on Map<a class="headerlink" href="#project-week-5-display-zika-reports-on-map" title="Permalink to this headline">¶</a></h1>
<p>We have an empty interactive map from OSM.</p>
<p>We need to create a new Layer in OpenLayers that will represent our Zika report data.</p>
<p>This will require a fair amount of work, luckily it is primarily things we did in our <a class="reference external" href="../../studios/airwaze/" target="_blank">Airwaze project<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>.</p>
<dl class="docutils">
<dt>Tasks:</dt>
<dd><ul class="first last simple">
<li>Design Report.java class</li>
<li>Create ReportTests.java</li>
<li>Report table is populated from CSVs</li>
<li>Create ReportTests.java</li>
<li>Create ReportController.java</li>
<li>Create ReportControllerTests.java</li>
<li>Create ReportRepository.java</li>
<li>Create ReportRepositoryTests.java</li>
<li>Amend script.js</li>
<li>Verify Zika report layer renders</li>
<li>Commit</li>
</ul>
</dd>
</dl>
<div class="section" id="design-report-java-class">
<h2>Design Report.java Class<a class="headerlink" href="#design-report-java-class" title="Permalink to this headline">¶</a></h2>
<p>Before we display our report data as a layer on our map in OSM we will first have to transform our data into a state we can work with.</p>
<p>Ultimately OpenLayers is expecting a source of data in a GeoJSON format. Right now our data is locked away in various CSV files. You can find the files you will need in the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/zika-data" target="_blank">zika-data repository<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> on GitLab.</p>
<dl class="docutils">
<dt>Let’s consider the journey of our data.</dt>
<dd><ol class="first last arabic simple">
<li>Report data exists as 6 CSV files</li>
<li>CSV files are copied as records in a report table in a PostGIS database</li>
<li>JpaRepository loads records from PostGIS and stores them as Report objects</li>
<li>Report objects are converted into GeoJSON</li>
<li>OpenLayers consumes GeoJSON to create a visual layer on a map</li>
</ol>
</dd>
</dl>
<p>In order to COPY our CSVs into a PostGIS table, the table must exist, and it’s columns must match the SQL COPY statement. We have been using Hibernate to create our PostGIS tables for us, Spring scans our project for the &#64;Entity annotation, and automatically creates a table based on the properties of that class. In order to create our table we will first need to design our Report class!</p>
<p>Look over the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/zika-data" target="_blank">provided CSV files<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> These  columns will be the columns in our table, and we need to create properties on our Report class to match these columns.</p>
<p>Look at your solution to the <a class="reference external" href="../../studios/airwaze/" target="_blank">Airwaze Studio<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>. Take note of how the <code class="docutils literal notranslate"><span class="pre">Airports.csv</span></code> file matches up with the <code class="docutils literal notranslate"><span class="pre">models/Airport.java</span></code> file, and how the <code class="docutils literal notranslate"><span class="pre">routes.csv</span></code> file matches up with the <code class="docutils literal notranslate"><span class="pre">models/Route.java</span></code> file.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Hibernate uses the <a class="reference external" href="https://en.wikipedia.org/wiki/Snake_case" target="_blank">snake case<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> naming strategy. You can explicitly define a Column name by using the Spring Data &#64;Column annotation. Above the property declaration you can include the &#64;Column(name = “columnName”) annotation and Hibernate will name the column based on the value mapped to the name variable.</p>
</div>
<p>After you create your Report.java class re-run <code class="docutils literal notranslate"><span class="pre">bootRun</span></code>, and then check your database. Your report table still won’t have any records in it, but you should see a report table with columns that match the properties of your Report class.</p>
</div>
<div class="section" id="create-reporttests-java">
<h2>Create ReportTests.java<a class="headerlink" href="#create-reporttests-java" title="Permalink to this headline">¶</a></h2>
<p>When creating a new class in Java we should test this file.</p>
<p>Create <code class="docutils literal notranslate"><span class="pre">ReportTests.java</span></code> in your tests directory. Look over the <a class="reference external" href="../../walkthroughs/unit-tests/" target="_blank">Unit Testing walkthrough<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> if you need help writing these tests.</p>
<p>We advise creating a <code class="docutils literal notranslate"><span class="pre">testReportConstructor()</span></code> method that will create a new <code class="docutils literal notranslate"><span class="pre">testReport</span></code> object based on information  from one of the CSV files. This will allow you to perform <code class="docutils literal notranslate"><span class="pre">assertEquals</span></code> statements to verify the <code class="docutils literal notranslate"><span class="pre">testReport</span></code> object contains information that matches our CSV file.</p>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">In most cases people will not test constructors in Java, or any language. An object constructor is code handled by the team responsible for the programming language itself, and you typically don’t test code written by third parties. The purpose of this class is learning, and practice. So we will be creating a test case for our constructor.</p>
</div>
</div>
<div class="section" id="populate-report-table">
<h2>Populate Report table<a class="headerlink" href="#populate-report-table" title="Permalink to this headline">¶</a></h2>
<p>Now that we have a tested Report class, which created the correct structure for our report table, we want to populate the table with the data from our CSV files.</p>
<p>In our <code class="docutils literal notranslate"><span class="pre">application.properties</span></code> file we have this line: <code class="docutils literal notranslate"><span class="pre">spring.jpa.hibernate.ddl-auto=create</span></code>. This tells our spring project to create any tables by finding the <code class="docutils literal notranslate"><span class="pre">&#64;Entity</span></code> annotations, and it tells our spring project to run the <code class="docutils literal notranslate"><span class="pre">import.sql</span></code> file found in our resources folder. We can include our COPY statement inside this SQL file and our records will be added to the database when our project starts up!</p>
<p>You are going to have to create your own COPY statement. Look at the <code class="docutils literal notranslate"><span class="pre">import.sql</span></code> file in your solution to the <a class="reference external" href="../../studios/airwaze/" target="_blank">Airwaze studio<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> to see how they crafted the COPY statement.</p>
<dl class="docutils">
<dt>The SQL COPY statement includes:</dt>
<dd><ul class="first last simple">
<li>COPY - the statement we are running in SQL</li>
<li>table_name - the table we are copying records into</li>
<li>(column_name1, column_name2, column_name3, etc) - the columns the data in the CSV file is being mapped to</li>
<li>from <code class="docutils literal notranslate"><span class="pre">/path/to/file.csv</span></code> - the CSV file we are copying data from</li>
<li>DELIMITER ‘,’ - the delimiter for this CSV file is a comma</li>
<li>CSV HEADER - this file includes a header row as the first row and it should be ignored when copying records</li>
</ul>
</dd>
</dl>
<p>We are using a PostGIS Docker container, so the path to your file will be <code class="docutils literal notranslate"><span class="pre">/tmp/filename.csv</span></code>. And you will have to copy the CSV files to this location.</p>
<p>You can copy a file to your docker container from the command line with the following command.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Docker cp</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">docker cp &lt;file_to_copy&gt; &lt;container&gt;:/tmp</span>
</pre></div>
</div>
</div>
<p>This command will copy your file to the /tmp folder in your docker container. You will need to do this for each file you need to copy to the report table!</p>
<p>After you are done with this, you should re-run <code class="docutils literal notranslate"><span class="pre">bootRun</span></code> to make sure it copies the records into the database correctly. It would also be a good time to review the options for <code class="docutils literal notranslate"><span class="pre">spring.jpa.hibernate.ddl-auto</span></code>. The final section of <a class="reference external" href="https://www.baeldung.com/spring-boot-data-sql-and-schema-sql" target="_blank">this Baeldung article<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> gives some information on the differences between the options.</p>
</div>
<div class="section" id="create-reportrepository-java">
<h2>Create ReportRepository.java<a class="headerlink" href="#create-reportrepository-java" title="Permalink to this headline">¶</a></h2>
<p>Now that we have data in our database, we need a way to interact with the data from our web application. We can create, and copy records into the database, but we will have to add some additional code to access, or amend the records in the database.</p>
<p>We need to create a <code class="docutils literal notranslate"><span class="pre">ReportRepository.java</span></code> class. It is a good idea to store this class inside of it’s own folder we recommend using a <code class="docutils literal notranslate"><span class="pre">org/launchcode/zikaDashboard/data</span></code> folder. Separating your data Repositories from your models, and controllers is a way to stay organized, and will help other coders understand your project.</p>
<p>Our new repository class will need to extend JpaRepository. Look at the <code class="docutils literal notranslate"><span class="pre">AirportRepository.java</span></code> class from the <a class="reference external" href="../../studios/airwaze/" target="_blank">airwaze studio<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> for help on setting up this class.</p>
<p>Right now we are interested in basic CRUD functionality, and don’t need to add any additional methods. However, later in this project week you may need to add methods to find specific reports based on information about that report.</p>
</div>
<div class="section" id="create-reportrepositorytests-java">
<h2>Create ReportRepositoryTests.java<a class="headerlink" href="#create-reportrepositorytests-java" title="Permalink to this headline">¶</a></h2>
<p>In creating a new JpaRepository we need to write some tests as well. Look at the <code class="docutils literal notranslate"><span class="pre">AirportRepositoryTest.java</span></code> file from the <a class="reference external" href="../../studios/airwaze/" target="_blank">airwaze studio<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> for help.</p>
<p>We advise creating a <code class="docutils literal notranslate"><span class="pre">testGetAllReports()</span></code> method that uses <code class="docutils literal notranslate"><span class="pre">reportRepository</span></code> to load all reports into a list. You can then assert if the length of that list matches the number of records in your database. You can also pull out one of the reports and assert that the data matches.</p>
</div>
<div class="section" id="create-reportcontroller-java">
<h2>Create ReportController.java<a class="headerlink" href="#create-reportcontroller-java" title="Permalink to this headline">¶</a></h2>
<p>We have a Report class, a report table with records, and a ReportRepository to manage the flow of information between Spring, and the database. Now we need some way of handling an HTTP request from OpenLayers, and the response needs to include a GeoJSON representation of our report data.</p>
<p>As we have learned from this class the <code class="docutils literal notranslate"><span class="pre">&#64;Controller</span></code> annotation allows us to handle HTTP requests, and serve up HTTP responses. We will need a controller, an endpoint, and some logic to get the information from the database, turn it into GeoJSON, and then package it into an HTTP response.</p>
<p>Again, as a good practice we should store all of our controllers, in their own directory called <code class="docutils literal notranslate"><span class="pre">controllers/</span></code>. Create this new directory, and add a new file called <code class="docutils literal notranslate"><span class="pre">ReportController.java</span></code>.</p>
<p>In this file you will need to setup a new method handler for an endpoint that will return a GeoJSON representation of our report objects.</p>
<div class="section" id="convert-java-object-to-geojson">
<h3>Convert Java Object to GeoJSON<a class="headerlink" href="#convert-java-object-to-geojson" title="Permalink to this headline">¶</a></h3>
<p>Look over the <code class="docutils literal notranslate"><span class="pre">AirportController.java</span></code> file from the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/airwaze-studio/blob/master/src/main/java/com/launchcode/gisdevops/controllers/AirportController.java" target="_blank">Airwaze code base<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>.</p>
<p>You will note in this file the <code class="docutils literal notranslate"><span class="pre">getAirports()</span></code> request handler method is returning a FeatureCollection object. The FeatureCollection is the GeoJSON! Look over both the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/airwaze-studio/blob/master/src/main/java/com/launchcode/gisdevops/features/FeatureCollection.java" target="_blank">FeatureCollection.java<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> and <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/airwaze-studio/blob/master/src/main/java/com/launchcode/gisdevops/features/Feature.java" target="_blank">Feature.java<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> files.</p>
<p>You will need to recreate both of these files in your project in order to return our report data as GeoJSON. A Feature is one record in GeoJSON. A FeatureCollection is multiple Features together, still in GeoJSON.</p>
<p>Notice that the Feature, and FeatureCollection classes are using a new annotation we haven’t seen yet: <code class="docutils literal notranslate"><span class="pre">&#64;JsonSerialize(using</span> <span class="pre">=</span> <span class="pre">GeometrySerializer.class)</span></code>. The JsonSerializer takes our object and converts it into JSON. To convert our GeoINT information we will also need <code class="docutils literal notranslate"><span class="pre">GeoJSONSerializer.java</span></code>, and <code class="docutils literal notranslate"><span class="pre">WktHelper.java</span></code>.</p>
<p>All four of these files are how we are converting our Java Report objects into GeoJSON that is usable by JavaScript.</p>
<p>In the handler method you will need to load all of your reports from the ReportRepository, loop through each report, create a new Feature from each report, and add each Feature to the FeatureCollection, and finally return the FeatureCollection as a part of the HTTP response.</p>
</div>
</div>
<div class="section" id="create-reportcontrollertests-java">
<h2>Create ReportControllerTests.java<a class="headerlink" href="#create-reportcontrollertests-java" title="Permalink to this headline">¶</a></h2>
<p>Since we are creating a new class we also need to test the class. Look at the <code class="docutils literal notranslate"><span class="pre">AirportControllerTest.java</span></code> file from the <a class="reference external" href="../../studios/airwaze/" target="_blank">airwaze studio<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> for help.</p>
<p>We advise creating a <code class="docutils literal notranslate"><span class="pre">testGetReports()</span></code> method that will use MockMvc to perform a get request to the endpoint you created in your controller. You can expect the HTTP Status to be 200, and you should expect something about the number of reports, or something inside one of the reports.</p>
</div>
<div class="section" id="amend-script-js">
<h2>Amend script.js<a class="headerlink" href="#amend-script-js" title="Permalink to this headline">¶</a></h2>
<p>Now that we have taken our data from CSV to a report table to Report objects to GeoJSON, we can finally create a new Layer in OpenLayers.</p>
<p>You will need to create a new reportLayer, and add it to your map.</p>
<p>Look over the <code class="docutils literal notranslate"><span class="pre">script.js</span></code> file from the <a class="reference external" href="../../studios/airwaze/" target="_blank">airwaze studio<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> for help.</p>
</div>
<div class="section" id="verify-zika-report-layer-renders">
<h2>Verify Zika report layer renders<a class="headerlink" href="#verify-zika-report-layer-renders" title="Permalink to this headline">¶</a></h2>
<p>And finally, re-run your project, and make sure your Layer is displaying properly.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Make sure you have created a style for your Report Layer. The browser can’t render the Layer if it doesn’t know what the Layer should look like.</p>
</div>
</div>
<div class="section" id="commit">
<h2>Commit<a class="headerlink" href="#commit" title="Permalink to this headline">¶</a></h2>
<p>After your tests pass, and you have manually checked your project commit and push your work!</p>
<p>Back to <a class="reference internal" href="../project/index.html#week5-project"><span class="std std-ref">Week 5 - Project Week: Zika Mission Control</span></a>.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>