<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Walkthrough: Spring Integration Tests &#8212; LaunchCode: GIS DevOps  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Walkthrough: SwaggerUI" href="../swagger/index.html" />
    <link rel="prev" title="Walkthrough: Cars Demo - Spring Data, JPA, Hibernate" href="../spring-data-jpa-hibernate/index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
          GIS DevOps</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="/installations/index.html">Installations</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ol>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day1/index.html">Week 1 - Day 1: Welcome, Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day2/index.html">Week 1 - Day 2: Terminal, Shell, Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day3/index.html">Week 1 - Day 3: Shell, Git, SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day4/index.html">Week 1 - Day 4: SQL, HTTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day5/index.html">Week 1 - Day 5: HTTP, Docker</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day1/index.html">Week 2 - Day 1: HTML, CSS, Browser DevTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day2/index.html">Week 2 - Day 2: HTML/CSS Template, JavaScript Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day3/index.html">Week 2 - Day 3: Programming Fundamentals, JavaScript, DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day4/index.html">Week 2 - Day 4: JS, DOM, Promises, AJAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day5/index.html">Week 2 - Day 5: Promises, AJAX, HTTP</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day1/index.html">Week 3 - Day 1: Java, OOP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day2/index.html">Week 3 - Day 2: Spring Boot, Controllers, Routes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day3/index.html">Week 3 - Day 3: Models, ORM (Hibernate)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day4/index.html">Week 3 - Day 4: Persistence, ORM Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day5/index.html">Week 3 - Day 5: Review</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day1/index.html">Week 4 - Day 1: Git, GitLab, IntelliJ, Refactoring, Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day2/index.html">Week 4 - Day 2: Security, Test-driven development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day3/index.html">Week 4 - Day 3: Integration testing, dependency injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day4/index.html">Week 4 - Day 4: Postgres, Spring Data, JPA, Hibernate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day5/index.html">Week 4 - Day 5: AJAX, Open Layers</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week05/project/index.html">Week 5 - Project Week: Zika Mission Control</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day1/index.html">Week 6 - Day 1: RESTful web services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day2/index.html">Week 6 - Day 2: Swagger REST framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day3/index.html">Week 6 - Day 3: Intro to Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day4/index.html">Week 6 - Day 4: More Elasticsearch, Integrating ES with Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day5/index.html">Week 6 - Day 5: ES2015, ESLint, OpenLayers</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week07/project/index.html">Week 7 - Project Week: Zika Mission Control Part 2</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day1/index.html">Week 8 - Day 1: Intro to DevOps/AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day2/index.html">Week 8 - Day 2: More with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day3/index.html">Week 8 - Day 3: 12 Factor Apps and Auto Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day4/index.html">Week 8 - Day 4: Gradle, Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day5/index.html">Week 8 - Day 5: Sonarqube</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week09/project/index.html">Week 9 - Project Week: Zika Mission Control Part 3</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week11/project/index.html">Week 11 - Project Week: Zika Mission Control Part 4</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day3/index.html">Week 12 - Day 3: Intro to Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day4/index.html">Week 12 - Day 4: OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day5/index.html">Week 12 - Day 5: Certificates</a></li>
</ol>
<ol class="current">
<li class="toctree-l1"><a class="reference internal" href="../aws-intro/index.html">Walkthrough: Intro to AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws-rds-vpc/index.html">Walkthrough: Introduction to Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../certificate-authority/index.html">Certificate Authority</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client-certificates/index.html">Client Certificates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Walkthrough: Intro to Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch-spring/index.html">Walkthrough: Elasticsearch in Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch/index.html">Walkthrough: Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch2/index.html">Walkthrough: Elasticsearch Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eslint-airwaze/index.html">Walkthrough: ESLint Airwaze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gitLab/index.html">Walkthrough: Git and Gitlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gradle/index.html">Walkthrough: Gradle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hashing-salting/index.html">Walkthrough: Hashing and Salting Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jenkins/index.html">Walkthrough: CI/CD With Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../launchcart-rest/index.html">Walkthrough: LaunchCart REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oauth2/index.html">Visual OAuth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openlayers/index.html">Walkthrough: OpenLayers and jQuery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postgress/index.html">Walkthrough: PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sonarqube/index.html">Walkthrough: Sonarqube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spring-data-jpa-hibernate/index.html">Walkthrough: Cars Demo - Spring Data, JPA, Hibernate</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Walkthrough: Spring Integration Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../swagger/index.html">Walkthrough: SwaggerUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tdd/index.html">Walkthrough: TDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit-tests/index.html">Walkthrough: Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading-spring-boot/index.html">Walkthrough: Upgrading to Spring Boot 2.x</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../installations/00-prep-week/index.html">Installation: Essential Tooling &amp; Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/01-docker/index.html">Installation: Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/02-docker-psql/index.html">Installation: Docker PSQL Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/03-docker-postgis/index.html">Installation: Docker PostGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/04-docker-elasticsearch/index.html">Installation: Docker Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/05-docker-kibana/index.html">Installation: Docker Kibana</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/06-docker-jenkins/index.html">Installation: Docker Jenkins</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/00-intellij/index.html">Configuration: IntelliJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/01-runtime-configurations/index.html">Configuration: IntelliJ - Runtime Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/02-environment-variables-intellij/index.html">Configuration: Environment Variables - IntelliJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/04-spring-elasticsearch/index.html">Configuration: Spring &amp; Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/05-spring-postgres/index.html">Configuration: Spring &amp; Postgres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/06-vscode-eslint/index.html">Configuration: Visual Studio Code - ESLint</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../notes/docker/index.html">Docker</a></li>
</ol>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Walkthrough: Spring Integration Tests</a><ul>
<li><a class="reference internal" href="#concept">Concept</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#intergrationtestconfig">IntergrationTestConfig</a></li>
<li><a class="reference internal" href="#mockmvc">MockMvc</a></li>
<li><a class="reference internal" href="#memoryrepository">MemoryRepository</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#explore-provided-files">Explore Provided Files</a></li>
<li><a class="reference internal" href="#write-the-tests">Write The Tests</a></li>
<li><a class="reference internal" href="#resources">Resources</a><ul>
<li><a class="reference internal" href="#class-level-configuration">Class-level Configuration</a></li>
<li><a class="reference internal" href="#executing-and-verifying-results">Executing and Verifying Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="walkthrough-spring-integration-tests">
<span id="sit-walkthrough"></span><h1>Walkthrough: Spring Integration Tests<a class="headerlink" href="#walkthrough-spring-integration-tests" title="Permalink to this headline">¶</a></h1>
<div class="section" id="concept">
<h2>Concept<a class="headerlink" href="#concept" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>With integration testing our objective is to ensure the technologies work together correctly. In this walkthrough we will focus on our Controller class. We want to make sure that when an HTTP Request is made to a specific endpoint, the HTTP Response that is sent back contains the correct information. This will be verifying that our Controller class handles requests, interacts with the Database, creates a POJO (Java Object), and returns a valid HTTP Response.</p>
</div>
<div class="section" id="intergrationtestconfig">
<h3>IntergrationTestConfig<a class="headerlink" href="#intergrationtestconfig" title="Permalink to this headline">¶</a></h3>
<p>In order to run our Integration Tests within Spring we need to configure a few tools. In your project you have been provided with an <code class="docutils literal notranslate"><span class="pre">IntegrationTestConfig.java</span></code> file. This file only does a few things, but is necessary for writing our integration tests.</p>
<img alt="../../_images/IntegrationTestConfig.png" src="../../_images/IntegrationTestConfig.png" />
<p>If you are looking for more information you should look up what these different annotations do. The most important annotation for writing our Integration Tests is <code class="docutils literal notranslate"><span class="pre">&#64;AutoConfigureMockMvc</span></code>, it handles Dependency Injection. We are injecting the MockMvc into this interface, and when we inject this interface into our Controller Test we will have access to MockMvc.</p>
</div>
<div class="section" id="mockmvc">
<h3>MockMvc<a class="headerlink" href="#mockmvc" title="Permalink to this headline">¶</a></h3>
<p>To write these tests we will be working with a new library inside of the Spring testing framework: <strong>MockMvc</strong>.</p>
<p>The MockMvc library will allow us to make HTTP Requests, and then make assert statements against the returned HTTP Response.</p>
<img alt="../../_images/integration-test-mockmvc.png" src="../../_images/integration-test-mockmvc.png" />
<p>In the example picture above. We are using mockMvc to make an HTTP get request to the /car endpoint. Then we are expecting the resulting HTTP Response to have a status code of 200, and the content (HTML/JSON/XML, etc) to contain the string <code class="docutils literal notranslate"><span class="pre">&quot;Mustang&quot;</span></code>, and contain the string <code class="docutils literal notranslate"><span class="pre">&quot;Camry&quot;</span></code>. If all three of these conditions are true, this test will pass. If any of those conditions are false, this test will fail.</p>
</div>
<div class="section" id="memoryrepository">
<h3>MemoryRepository<a class="headerlink" href="#memoryrepository" title="Permalink to this headline">¶</a></h3>
<p>In order to test that our technologies are working together correctly we will need access to the database, so we can fill it with data, and then check our HTTP Responses against that data.</p>
<p>We will be using a <strong>JPA Repository</strong> to do this. We will talk about JPA Repositories in greater depth later this instruction week.</p>
<p>What you need to know for today is that we will be using a JPA Repository to put dummy data into our database. Every time we create a POJO (Java Object) we will save it to the JPA Repository so it’s stored in our database. In today’s example we will be working with <code class="docutils literal notranslate"><span class="pre">CarMemoryRepository</span></code> which is a class provided for you. You can find this Class in the data folder within your source.</p>
<p>We will Autowire it into our test file.</p>
<img alt="../../_images/integration-test-car-memory-repository.png" src="../../_images/integration-test-car-memory-repository.png" />
</div>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Fork this repo: <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/car-integration-test-starter/" target="_blank">Car Integration Tests<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></li>
<li>Create a story branch <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">walkthrough-solution</span></code></li>
<li>Open project in Intellij by opening gradle.build file as a project</li>
</ol>
</div>
<div class="section" id="explore-provided-files">
<h2>Explore Provided Files<a class="headerlink" href="#explore-provided-files" title="Permalink to this headline">¶</a></h2>
<p>You are provided with quite a few files already. This project extends the Unit Tests, and TDD tests we worked on in previous lessons. We will be making car objects, and testing them.</p>
<p>In your test directory you have a models directory that holds a file that is full of unit tests.</p>
<p>There is also an <code class="docutils literal notranslate"><span class="pre">IntegrationTestConfig.java</span></code> file, that configures the Integration Tests we will be writing, and there is a <code class="docutils literal notranslate"><span class="pre">CarControllerTest.java</span></code> file. This is where we will write any integration tests for our CarController. Inside of this file we have an empty test, and we setup MockMvc, and carRepository.</p>
<p>Exploring our Main directory we have a controller directory, data directory, models directory, and our <code class="docutils literal notranslate"><span class="pre">CarApplication.java</span></code> file. This is where the logic of our MVC app lives.</p>
<ul class="simple">
<li>models - where our Car class lives</li>
<li>data - where our JPA Repository lives</li>
<li>controllers - where the controllers for HTTP Requests live</li>
</ul>
<p>Looking in our <code class="docutils literal notranslate"><span class="pre">CarController.java</span></code> file we are provided with 2 routes off of the car mapping.</p>
<ul class="simple">
<li>/seedData - a route that allows us to put some data into the database</li>
<li>/ - the index of our car route that simply returns a template found at “car/index” and adds all the cars found in the database.</li>
</ul>
<p>The CarController is what we will be testing with our integration testing.</p>
</div>
<div class="section" id="write-the-tests">
<h2>Write The Tests<a class="headerlink" href="#write-the-tests" title="Permalink to this headline">¶</a></h2>
<p>Our first test will be for getting a list of all cars by going to the /car route.</p>
<p>Steps:</p>
<ul class="simple">
<li>Add test cars to the database</li>
<li>Perform GET request to /car</li>
<li>Check that HTTP Response contains the information it should</li>
</ul>
<img alt="../../_images/integration-test-view-list-of-cars.png" src="../../_images/integration-test-view-list-of-cars.png" />
<p>Let’s run our test.</p>
<img alt="../../_images/integration-test-view-list-of-cars-result.png" src="../../_images/integration-test-view-list-of-cars-result.png" />
<p>That test passed! We can move on.</p>
<p>Our next test is for checking the result of one single car. Instead of a list of all cars in the database, we want to make sure that one car can be returned when we request a car by a specific ID number. This code has not been provided for us. So following Red-Green-Refactor workflow, we will write our test, watch it fail, write the code to make the test pass, and then refactor if necessary.</p>
<p>Steps:</p>
<ul class="simple">
<li>Add test car to database</li>
<li>Perform GET request to /car/&lt;ID&gt;</li>
<li>Check that the HTTP Response contains the information it should</li>
<li>Add code to make test pass</li>
<li>Refactor code if necessary</li>
</ul>
<img alt="../../_images/integration-test-view-by-id.png" src="../../_images/integration-test-view-by-id.png" />
<p>Let’s run our test.</p>
<img alt="../../_images/integration-test-view-by-id-result1.png" src="../../_images/integration-test-view-by-id-result1.png" />
<p>Our test failed. Luckily MockMvc gives us a lot of information when a test fails. It tells us the HTTP Request that was made, and the HTTP Response. Scroll through this output and read it. The image above shows why this test failed. The HTTP Response that was returned had a status code of 404, but our test is expecting a status code of 200. The resource was not found. This usually means the URL is incorrect. In our case it’s because we have not yet created the controller that will handle this endpoint. We will have to write some code for this endpoint.</p>
<p>We will need to add new code to our <code class="docutils literal notranslate"><span class="pre">CarController.java</span></code> file to create a new RequestMapping.</p>
<img alt="../../_images/integration-test-new-request-mapping.png" src="../../_images/integration-test-new-request-mapping.png" />
<p>In this request mapping we are accessing a path variable. Each car will have a different, and unique ID. A user of this application can request information about a specific car by making an HTTP Request to /car/&lt;car.id&gt; and include in the path the ID number of the car they are requesting. We are using the builtin PathVariable annotation to do this. You will have to import this into the file to use it. Option+enter is the easiest way to do this on a Mac.</p>
<p>We will use the ID number given to us in the PathVariable to look up the car in the database. Using the Car Repository we want to look up one car, with a specific ID number. The method we are calling doesn’t currently exist, so we will need to add it. In CarMemoryRepository we will need to add a little code.</p>
<img alt="../../_images/integration-test-car-memory-repository-addition.png" src="../../_images/integration-test-car-memory-repository-addition.png" />
<p>Now that the method exists, we now have access to this code in our <code class="docutils literal notranslate"><span class="pre">CarController.java</span></code> file. If you switch back to the file you should see the red text on findById() has changed to black text.</p>
<p>Let’s run our test.</p>
<img alt="../../_images/integration-test-view-by-id-result2.png" src="../../_images/integration-test-view-by-id-result2.png" />
<p>Our test failed again! However the output looks a little different. We are now getting an error in resolving our template: “car/view”, template might not exist. In the code we added to our controller we told it to return a template located in the car folder called view.html. Looking at our project structure we don’t have that file.</p>
<img alt="../../_images/integration-test-project-structure.png" src="../../_images/integration-test-project-structure.png" />
<p>We will need to add an additional file, with some HTML to pass this test.</p>
<img alt="../../_images/integration-test-view-template.png" src="../../_images/integration-test-view-template.png" />
<p>Now that the route exists. Let’s rerun our test.</p>
<img alt="../../_images/integration-test-view-by-id-result3.png" src="../../_images/integration-test-view-by-id-result3.png" />
<p>Finally it passed!</p>
<p>We wrote a Red test, we added the code necessary to make the test green, and the next step would be to refactor our code if necessary. We won’t refactor together, but it’s something you will be expected to do in your studio today.</p>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/testing.html#integration-testing" target="_blank">Spring framework<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></li>
</ul>
<div class="section" id="class-level-configuration">
<h3>Class-level Configuration<a class="headerlink" href="#class-level-configuration" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation</th>
<th class="head">What it does</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&#64;RunWith(SpringRunner.class)</span></code></td>
<td>runs tests with the given test runner</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">&#64;SpringBootTest(classes</span> <span class="pre">|</span> <span class="pre">Application.class)</span></code></td>
<td>ensures proper Spring web app context is loaded (including loading of framework components like controllers, DAOs, etc)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&#64;TestPropertySource(locations</span> <span class="pre">=</span> <span class="pre">&quot;classpath:application-test.properties&quot;)</span></code></td>
<td>replaces use of application.properties with the given file</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">&#64;AutoConfigureMockMvc</span></code></td>
<td>allows for autowiring of MockMvc instance</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&#64;Transactional</span></code></td>
<td>wraps each test method in a transaction, and rolls it back after each method runs</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="executing-and-verifying-results">
<h3>Executing and Verifying Results<a class="headerlink" href="#executing-and-verifying-results" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Info</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">MockMvc.perform(RequestBuilder</span> <span class="pre">requestBuilder)</span></code></td>
<td>Perform a request and return a type that allows chaining further actions, such as asserting expectations, on the result. <a class="reference external" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/web/servlet/MockMvc.html" target="_blank">More info on MockMvc<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">MockMvcRequestBuilders.get(String</span> <span class="pre">uri)</span></code></td>
<td>static method that performs a GET request. Returns a MockMvcRequestBuilder that can be chained. <a class="reference external" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/test/web/servlet/request/MockMvcRequestBuilders.html" target="_blank">More info on MockMvcRequestBuilders<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">MockMvcRequestBuilders.post()</span></code></td>
<td>static method that performs a GET request. Returns a MockMvcRequestBuilder that can be chained.  <a class="reference external" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/test/web/servlet/result/MockMvcResultMatchers.html" target="_blank">More info on MockMvcResultMatchers<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">MockMvcRequestMatchers</span> <span class="pre">-</span> <span class="pre">content(),</span> <span class="pre">jsonPath(),</span> <span class="pre">status()</span></code></td>
<td>The type of result to expect: HTML, JSON, status…  More info</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">ResultActions</span> <span class="pre">-</span> <span class="pre">andExpect()</span></code></td>
<td>What to look for in the result: status code, a string, JSON value…  <a class="reference external" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/test/web/servlet/ResultActions.html" target="_blank">More info<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>